=====
 lxd
=====

apt remove --purge lxd* lxd-client*
snap install lxd
lxd --version
  3.6

lxd init

lxc profile device set default root size 20GB

lxc launch ubuntu:18.04 base
lxc config set base limits.cpu 1
lxc config set base limits.memory 1GB
lxc exec base bash

apt update
apt upgrade
apt autoremove

adduser dml
visudo
  dml ALL=(ALL) NOPASSWD: ALL
deluser ubuntu --remove-home
su - dml
mkdir .ssh
cd .ssh
nano authorized_keys
  [put public key]
chmod 600 authorized_keys
exit

[ install node_exporter ]

exit

lxc stop base

#lxc config device add prmths0 root disk pool=default path=/ size=50GB

lxc copy base mon0 --container-only
lxc config set mon0 limits.cpu 2
lxc start mon0
lxc exec mon0 bash

deluser ubuntu --remove-home
nano /etc/hosts
  127.0.1.1 mon0

[ install prometheus ]
[ install grafana ]

apt remove --purge lxd* lxc*


lxc storage create vol1 zfs source=vol1

lxc storage create data zfs size=500GB

lxc storage list

lxc copy base es --container-only -s data


lxc config device add docker0 m0n1t0r disk path=/home/dml/ws/m0n1t0r source=/home/dml/git/m0n1t0r


=====================
 Container Migration
=====================
https://stgraber.org/2016/04/12/lxd-2-0-remote-hosts-and-container-migration-612/

Remote
  lxc config set core.https_address [::]:8443
  lxc config set core.trust_password

Local
  lxc config set core.https_address [::]:8443
  lxc remote add esc0 10.0.0.46
  lxc remote list
  lxc remote get-default

  lxc copy hb esc0: --mode push

  lxc move base0 mac:
  lxc move prmths0 mac:
  lxc move vis0 mac:
  lxc move nginx0 mac:


lxc config unset core.https_address
